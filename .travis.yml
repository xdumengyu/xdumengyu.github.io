language: node_js
node_js:
  - 6.9.1
sudo: false
branches:
  only:
  - src
before_install:
- cd ./blog
- git config --global user.name "xdumengyu"
- git config --global user.email "xdumengyu@gmail.com"

install:
- npm install hexo-cli -g
- npm install

script:
- hexo clean
- hexo g

env:
  global:
    - GH_REF: github.com/xdumengyu/xdumengyu.github.io

after_success:
- cd ./public
- git init
- git add -A
- git commit -m "travis_update"
- git push --force --quiet "https://${REPO_TOKEN}@{GH_REF}" master:master

